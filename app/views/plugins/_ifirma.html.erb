        <script type="text/javascript">
            var chart;

  	    var chartData = <%= @plugin.chart_data[:chart_data].to_json.html_safe %>;

            AmCharts.ready(function () {
                // SERIAL CHART
                chart = new AmCharts.AmSerialChart();
                chart.pathToImages = "/assets/amcharts/";
                chart.zoomOutButton = {
                    backgroundColor: '#000000',
                    backgroundAlpha: 0.15
                };
                chart.dataProvider = chartData;
                chart.categoryField = "year";

                // AXES
                // Category
                var categoryAxis = chart.categoryAxis;
                categoryAxis.parseDates = true; // in order char to understand dates, we should set parseDates to true
                categoryAxis.minPeriod = "ss"; // as we have data with minute interval, we have to set "mm" here.			 
                categoryAxis.gridAlpha = 0.07;
                categoryAxis.axisColor = "#DADADA";
                categoryAxis.startOnAxis = true;

                // Value
                var valueAxis = new AmCharts.ValueAxis();
                valueAxis.stackType = "regular"; // this line makes the chart "stacked"
                valueAxis.gridAlpha = 0.07;
                valueAxis.title = "Traffic incidents";
                chart.addValueAxis(valueAxis);


                // GRAPHS
                var graph = new AmCharts.AmGraph();
		<% @plugin.chart_data[:instances].each_key do |instance| %>
                graph = new AmCharts.AmGraph();
                graph.type = "line";
                graph.title = "<%= instance %>";
                graph.valueField = "<%= instance %>";
                graph.lineAlpha = 1;
                graph.fillAlphas = 0.6;
                chart.addGraph(graph);
		<% end %>

                // LEGEND
                var legend = new AmCharts.AmLegend();
                legend.position = "top";
                chart.addLegend(legend);

		//SCROLLBAR
                var chartScrollbar = new AmCharts.ChartScrollbar();
                chartScrollbar.graph = graph;
                chartScrollbar.scrollbarHeight = 30;
                chartScrollbar.color = "#FFFFFF";
                chartScrollbar.graphType = "step";
                chartScrollbar.autoGridCount = true;
                chart.addChartScrollbar(chartScrollbar);
                // CURSOR
                var chartCursor = new AmCharts.ChartCursor();
                chartCursor.cursorPosition = "mouse";
                chartCursor.categoryBalloonDateFormat = "YYYY:MM:DD, HH:NN:SS";
                chartCursor.zoomable = false; // as the chart displayes not too many values, we disabled zooming
                chartCursor.cursorAlpha = 0;
                chart.addChartCursor(chartCursor);

                // WRITE
                chart.write("chartdiv");
            });
        </script>
    
        <div id="chartdiv" style="width:100%; height:400px;"></div>
